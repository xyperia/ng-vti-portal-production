"use strict";(self.webpackChunkvtidev_ng13=self.webpackChunkvtidev_ng13||[]).push([[551],{6551:(F,p,r)=>{r.r(p),r.d(p,{RuleManagementModule:()=>k});var d=r(5947),u=r(4036),a=r(5211),h=r(3739),f=r(9319),e=r(2079),v=r(5238),b=r(3464);function T(n,o){1&n&&(e.TgZ(0,"div")(1,"h4",23),e._uU(2,"New Rule"),e.qZA()())}function R(n,o){1&n&&(e.TgZ(0,"h4",23),e._uU(1,"Edit Rule"),e.qZA())}function M(n,o){1&n&&(e.TgZ(0,"div",25),e._uU(1,"*rule name required"),e.qZA())}function U(n,o){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,M,2,0,"div",24),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.RULE_NAME.errors.required)}}function x(n,o){1&n&&e._UZ(0,"span")}const E=function(n){return{"is-invalid":n}};let Z=(()=>{class n{constructor(t,i,l,s,c){this.formBuilder=t,this.route=i,this.router=l,this.ruleService=s,this.alertService=c,this.subs=new f.Y,this.loading=!1,this.submitted=!1}ngOnInit(){this.id=this.route.snapshot.params.id,this.isAddMode=!this.id,this.form=this.formBuilder.group({RULE_NAME:["",a.kI.required],USER_MGMT:[""],ACTIVITY_MGMT:[""],LEADERBOARDS_PAGE:[""],CONTENT_MGMT:[""],PIPELINES_PAGE:[""],REVENUE_LEADERBOARD:[""]}),this.isAddMode||this.subs.add(this.ruleService.getByID(this.id).subscribe(t=>this.form.patchValue(t)))}get f(){return this.form.controls}onSubmit(){this.submitted=!0,this.alertService.clear(),!this.form.invalid&&(this.loading=!0,this.isAddMode?this.createRole():this.updateRule())}createRole(){this.alertService.loading(),this.subs.add(this.ruleService.register(this.form.value).pipe((0,h.P)()).subscribe({next:()=>{this.alertService.success(),this.router.navigate(["../"],{relativeTo:this.route})},error:t=>{this.alertService.error(t),this.loading=!1}}))}updateRule(){this.alertService.loading(),this.subs.add(this.ruleService.update(this.id,this.form.value).pipe((0,h.P)()).subscribe({next:()=>{this.alertService.success(),this.router.navigate(["../../"],{relativeTo:this.route})},error:t=>{this.alertService.error(t),this.loading=!1}}))}getRandomInt(t){return Math.floor(Math.random()*t)}ngOnDestroy(){this.subs.unsubscribe()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(a.qu),e.Y36(u.gz),e.Y36(u.F0),e.Y36(v.P),e.Y36(b.c))},n.\u0275cmp=e.Xpm({type:n,selectors:[["ng-component"]],decls:59,vars:9,consts:[[1,"title","d-flex","align-items-center","flex-wrap","mb-30"],[4,"ngIf","ngIfElse"],["editMode",""],["routerLink","/rule-management",1,"main-btn","primary-btn","rounded-btn","btn-hover","btn-sm"],[1,"lni","lni-chevron-left","mr-5"],[1,"row"],[3,"formGroup","ngSubmit"],[1,"col-lg-6"],[1,"card-style","mb-30"],[1,"divider"],[1,"input-style-1"],["type","text","formControlName","RULE_NAME",3,"ngClass"],[4,"ngIf"],[1,"form-check","form-switch","toggle-switch","mb-30"],["formControlName","USER_MGMT","type","checkbox","id","toggleSwitch1",1,"form-check-input"],["for","toggleSwitch1",1,"form-check-label"],["formControlName","ACTIVITY_MGMT","type","checkbox","id","toggleSwitch1",1,"form-check-input"],["formControlName","CONTENT_MGMT","type","checkbox","id","toggleSwitch1",1,"form-check-input"],["formControlName","LEADERBOARDS_PAGE","type","checkbox","id","toggleSwitch1",1,"form-check-input"],["formControlName","PIPELINES_PAGE","type","checkbox","id","toggleSwitch1",1,"form-check-input"],["formControlName","REVENUE_LEADERBOARD","type","checkbox","id","toggleSwitch1",1,"form-check-input"],["routerLink","/rule-management",1,"main-btn","primary-btn-outline","rounded-btn","btn-hover","btn-sm"],[1,"main-btn","primary-btn","rounded-btn","btn-hover","btn-sm",3,"disabled"],[1,"mr-40"],["style","color:red",4,"ngIf"],[2,"color","red"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0),e.YNc(1,T,3,0,"div",1),e.YNc(2,R,2,0,"ng-template",null,2,e.W1O),e.TgZ(4,"button",3),e._UZ(5,"i",4),e._uU(6,"Back"),e.qZA()(),e.TgZ(7,"div",5)(8,"form",6),e.NdJ("ngSubmit",function(){return i.onSubmit()}),e.TgZ(9,"div",7)(10,"div",8)(11,"h5"),e._uU(12,"Rule Description"),e.qZA(),e.TgZ(13,"span",9),e._UZ(14,"hr"),e.qZA(),e.TgZ(15,"div",10)(16,"label"),e._uU(17," Role Name "),e.qZA(),e._UZ(18,"input",11),e.YNc(19,U,2,1,"div",12),e.qZA(),e.TgZ(20,"span",9),e._UZ(21,"hr"),e.qZA(),e.TgZ(22,"h5"),e._uU(23,"Rule Privileges"),e.qZA(),e.TgZ(24,"span",9),e._UZ(25,"hr"),e.qZA(),e.TgZ(26,"div",13),e._UZ(27,"input",14),e.TgZ(28,"label",15),e._uU(29,"User Management"),e.qZA()(),e.TgZ(30,"div",13),e._UZ(31,"input",16),e.TgZ(32,"label",15),e._uU(33,"Activity Management"),e.qZA()(),e.TgZ(34,"div",13),e._UZ(35,"input",17),e.TgZ(36,"label",15),e._uU(37,"Content Management"),e.qZA()(),e.TgZ(38,"div",13),e._UZ(39,"input",18),e.TgZ(40,"label",15),e._uU(41,"Access Leaderboards"),e.qZA()(),e.TgZ(42,"div",13),e._UZ(43,"input",19),e.TgZ(44,"label",15),e._uU(45,"View Pipelines"),e.qZA()(),e.TgZ(46,"div",13),e._UZ(47,"input",20),e.TgZ(48,"label",15),e._uU(49,"View BP's Revenue Leaderboards"),e.qZA()(),e.TgZ(50,"span",9),e._UZ(51,"hr"),e.qZA(),e.TgZ(52,"div")(53,"button",21),e._uU(54," Cancel "),e.qZA(),e._uU(55,"\xa0 "),e.TgZ(56,"button",22),e.YNc(57,x,1,0,"span",12),e._uU(58," \xa0Save\xa0 "),e.qZA()()()()()()),2&t){const l=e.MAs(3);e.xp6(1),e.Q6J("ngIf",!i.id)("ngIfElse",l),e.xp6(7),e.Q6J("formGroup",i.form),e.xp6(10),e.Q6J("ngClass",e.VKq(7,E,i.submitted&&i.f.RULE_NAME.errors)),e.xp6(1),e.Q6J("ngIf",i.submitted&&i.f.RULE_NAME.errors),e.xp6(37),e.Q6J("disabled",i.loading),e.xp6(1),e.Q6J("ngIf",i.loading)}},directives:[d.O5,u.rH,a._Y,a.JL,a.sg,a.Fj,a.JJ,a.u,d.mk,a.Wl],encapsulation:2}),n})(),C=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["ng-component"]],decls:1,vars:0,template:function(t,i){1&t&&e._UZ(0,"router-outlet")},directives:[u.lC],encapsulation:2}),n})();var y=r(3821),S=r.n(y),N=r(1769),m=r(9913),L=r(440),I=r(7980),J=r(1004),g=r(9517),_=r(18);function q(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td")(4,"button",24),e._UZ(5,"i",25),e.qZA(),e.TgZ(6,"ul",26)(7,"li",27)(8,"a",28),e._uU(9,"Edit"),e.qZA()(),e.TgZ(10,"li",27)(11,"a",29),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.oxw(2).confirmBox("delete",s)}),e._uU(12,"Delete"),e.qZA()()()()()}if(2&n){const t=o.$implicit;e.xp6(2),e.hij(" ",t.RULE_NAME," "),e.xp6(6),e.MGl("routerLink","edit/",t.RULE_ID,"")}}const A=function(n,o){return{itemsPerPage:n,currentPage:o}};function w(n,o){if(1&n&&(e.TgZ(0,"tbody"),e.YNc(1,q,13,2,"tr",23),e.ALo(2,"paginate"),e.ALo(3,"filter"),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",e.xi3(2,1,e.xi3(3,4,t.rules,t.filterdata),e.WLB(7,A,t.count,t.p)))}}function Y(n,o){1&n&&(e.TgZ(0,"span"),e._UZ(1,"i",35),e.qZA())}function D(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"tr")(1,"td")(2,"p"),e._uU(3),e.qZA()(),e.TgZ(4,"td",30)(5,"div",31)(6,"button",32),e._UZ(7,"i",33),e.qZA(),e._uU(8,"\xa0 "),e.TgZ(9,"button",34),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.oxw(2).confirmBox("delete",s)}),e.YNc(10,Y,2,0,"span",18),e.qZA()()()()}if(2&n){const t=o.$implicit;e.xp6(3),e.Oqu(t.RULE_NAME),e.xp6(3),e.MGl("routerLink","edit/",t.RULE_ID,""),e.xp6(3),e.Q6J("disabled",t.isDeleting),e.xp6(1),e.Q6J("ngIf",!t.isDeleting)}}function B(n,o){if(1&n&&(e.TgZ(0,"tbody"),e.YNc(1,D,11,4,"tr",23),e.ALo(2,"paginate"),e.ALo(3,"filter"),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",e.xi3(2,1,e.xi3(3,4,t.rules,t.filterdata),e.WLB(7,A,t.count,t.p)))}}const O=[{path:"rule-management",component:C,children:[{path:"",component:(()=>{class n{constructor(t,i,l,s){this.apmService=t,this.service=i,this.alertService=l,this.localService=s,this.rules=null,this.subs=new f.Y,this.p=1,this.count=10,this.countdata=null;const c=t.init({serviceName:m.N.apmServerAppName,serverUrl:m.N.apmServerUrl,environment:m.N.apmServerEnv});this.user=JSON.parse(this.localService.getKey("user")),c.setUserContext({username:this.user.USERNAME,id:this.user.ID,email:this.user.EMAIL})}ngOnInit(){this.mobileMode=JSON.parse(localStorage.getItem("mobileMode")),this.user=new N.X(JSON.parse(this.localService.getKey("user"))),this.subs.add(this.service.getAll().subscribe(t=>{this.rules=t,this.countdata=this.rules.length}))}deleteRule(t){this.alertService.loading();const i=this.rules.find(l=>l.RULE_ID===t.RULE_ID);this.subs.add(this.service.delete(t.RULE_ID).subscribe(()=>{i.isDeleting=!0,this.rules=this.rules.filter(l=>l.RULE_ID!==t.RULE_ID),this.countdata=this.rules.length,this.alertService.success()},l=>{this.alertService.error(l)}))}confirmBox(t,i){"delete"==t&&S().fire({title:"Are you sure want to delete?",text:i.RULE_NAME,icon:"warning",showCancelButton:!0,confirmButtonText:"Yes!",cancelButtonText:"Cancel"}).then(l=>{l.value&&this.deleteRule(i)})}ngOnDestroy(){this.subs.unsubscribe()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(L.J5),e.Y36(v.P),e.Y36(I.c9),e.Y36(J.C))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-rule-management"]],decls:42,vars:4,consts:[[1,"title","d-flex","align-items-center","flex-wrap","mb-30"],[1,"mr-40"],["routerLink","add",1,"main-btn","primary-btn","btn-hover","btn-sm"],[1,"lni","lni-plus","mr-5"],[1,"row"],[1,"col-lg-12"],[1,"card-style","mb-30"],[1,"row","align-items-center"],[1,"col-md-6"],[1,"d-flex","flex-wrap","justify-content-between","align-items-center","py-3"],[1,"left"],[1,"right"],[1,"table-search","d-flex"],["action","#"],["type","text","name","something","placeholder","Search...",3,"ngModel","ngModelChange"],[1,"lni","lni-search-alt"],[1,"table-wrapper","table-responsive"],[1,"table"],[4,"ngIf"],[1,"pt-10","d-flex","flex-wrap","justify-content-between"],[1,"text-sm","text-gray"],[1,"text-right"],[3,"pageChange"],[4,"ngFor","ngForOf"],["id","moreAction1","data-bs-toggle","dropdown","aria-expanded","false",1,"main-btn"],[1,"lni","lni-more-alt"],["aria-labelledby","moreAction1",1,"dropdown-menu","dropdown-menu-end"],[1,"dropdown-item"],[1,"text-gray",2,"cursor","pointer",3,"routerLink"],[1,"text-gray",3,"click"],[1,"min-width"],[1,"action"],[1,"text-primary",2,"cursor","pointer",3,"routerLink"],[1,"lni","lni-pencil-alt"],[1,"text-danger",3,"disabled","click"],[1,"lni","lni-trash-can"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"h4",1),e._uU(2,"Rule Management"),e.qZA(),e.TgZ(3,"button",2),e._UZ(4,"i",3),e._uU(5," Add "),e.qZA()(),e.TgZ(6,"div",4)(7,"div",5)(8,"div",6)(9,"div",7),e._UZ(10,"div",8),e.qZA(),e.TgZ(11,"div",9)(12,"div",10)(13,"p"),e._uU(14,"Show "),e.TgZ(15,"span"),e._uU(16,"10"),e.qZA(),e._uU(17," entries"),e.qZA()(),e.TgZ(18,"div",11)(19,"div",12)(20,"form",13)(21,"input",14),e.NdJ("ngModelChange",function(s){return i.filterdata=s}),e.qZA(),e.TgZ(22,"button"),e._UZ(23,"i",15),e.qZA()()()()(),e.TgZ(24,"div",16)(25,"table",17)(26,"thead")(27,"tr")(28,"th")(29,"h6"),e._uU(30,"Rule Name"),e.qZA()(),e.TgZ(31,"th")(32,"h6"),e._uU(33,"Action"),e.qZA()()()(),e.YNc(34,w,4,10,"tbody",18),e.YNc(35,B,4,10,"tbody",18),e.qZA()(),e.TgZ(36,"div",19)(37,"div",10)(38,"p",20),e._uU(39),e.qZA()(),e.TgZ(40,"div",21)(41,"pagination-controls",22),e.NdJ("pageChange",function(s){return i.p=s}),e.qZA()()()()()()),2&t&&(e.xp6(21),e.Q6J("ngModel",i.filterdata),e.xp6(13),e.Q6J("ngIf",i.mobileMode),e.xp6(1),e.Q6J("ngIf",!i.mobileMode),e.xp6(4),e.hij("Total ",i.countdata," Rule Data"))},directives:[u.rH,a._Y,a.JL,a.F,a.Fj,a.JJ,a.On,d.O5,d.sg,u.yS,g.LS],pipes:[g._s,_.Z],styles:[""]}),n})()},{path:"add",component:Z},{path:"edit/:id",component:Z}]}];let P=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[u.Bz.forChild(O)],u.Bz]}),n})(),k=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[d.ez,P,a.UX,a.u5,g.JX,_.h]]}),n})()}}]);