"use strict";(self.webpackChunkvtidev_ng13=self.webpackChunkvtidev_ng13||[]).push([[252],{7252:(Nt,y,u)=>{u.r(y),u.d(y,{UserManagementModule:()=>yt});var a=u(5211),f=u(5947),v=u(4036),m=u(3739),N=u(9319),T=u(9913),t=u(2079),w=u(4385),D=u(7980),F=u(5238),Q=u(3783);let O=(()=>{class n{constructor(e){this.http=e}uploadImage(e){const s=new FormData;return s.append("image",e),this.http.post(`${T.N.apiUrl}/image`,s)}deleteImage(e){return this.http.delete(`${T.N.apiUrl}/image/delete/${e}`)}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(Q.eN))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var L=u(1004);function J(n,i){1&n&&(t.TgZ(0,"h4",23),t._uU(1,"New Users"),t.qZA())}function K(n,i){1&n&&(t.TgZ(0,"h4",23),t._uU(1,"Edit Users"),t.qZA())}function j(n,i){1&n&&(t.TgZ(0,"div",11)(1,"label"),t._uU(2,"Company Name"),t.qZA(),t._UZ(3,"input",24),t.qZA())}function z(n,i){1&n&&(t.TgZ(0,"div",11)(1,"label"),t._uU(2,"Username"),t.qZA(),t._UZ(3,"input",25),t.qZA())}function W(n,i){1&n&&(t.TgZ(0,"div",11)(1,"label"),t._uU(2,"Email"),t.qZA(),t._UZ(3,"input",26),t.qZA())}function G(n,i){1&n&&(t.TgZ(0,"em"),t._uU(1,"(Default Password is email)"),t.qZA())}function X(n,i){1&n&&(t.TgZ(0,"div",30),t._uU(1,"Password is required"),t.qZA())}function ee(n,i){1&n&&(t.TgZ(0,"div",30),t._uU(1,"Password must be at least 6 characters"),t.qZA())}function te(n,i){if(1&n&&(t.TgZ(0,"div"),t.YNc(1,X,2,0,"div",29),t.YNc(2,ee,2,0,"div",29),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",e.f.PASSWORD.errors.required),t.xp6(1),t.Q6J("ngIf",e.f.PASSWORD.errors.minlength)}}const g=function(n){return{"is-invalid":n}};function ie(n,i){if(1&n&&(t.TgZ(0,"div",11)(1,"label",27),t._uU(2," Password "),t.YNc(3,G,2,0,"em",10),t.qZA(),t._UZ(4,"input",28),t.YNc(5,te,3,2,"div",10),t.qZA()),2&n){const e=t.oxw();t.xp6(3),t.Q6J("ngIf",e.isAddMode),t.xp6(1),t.Q6J("ngClass",t.VKq(3,g,e.submitted&&e.f.PASSWORD.errors)),t.xp6(1),t.Q6J("ngIf",e.submitted&&e.f.PASSWORD.errors)}}function ne(n,i){1&n&&(t.TgZ(0,"div",30),t._uU(1,"*First Name required"),t.qZA())}function se(n,i){if(1&n&&(t.TgZ(0,"div"),t.YNc(1,ne,2,0,"div",29),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",e.f.FIRST_NAME.errors.required)}}function re(n,i){1&n&&(t.TgZ(0,"div",30),t._uU(1,"*Last Name required"),t.qZA())}function le(n,i){if(1&n&&(t.TgZ(0,"div"),t.YNc(1,re,2,0,"div",29),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",e.f.LAST_NAME.errors.required)}}function oe(n,i){1&n&&(t.TgZ(0,"div",30),t._uU(1,"*Phone No. required"),t.qZA())}function ae(n,i){if(1&n&&(t.TgZ(0,"div"),t.YNc(1,oe,2,0,"div",29),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",e.f.PHONE.errors.required)}}function ce(n,i){if(1&n&&(t.TgZ(0,"div")(1,"div",11)(2,"label"),t._uU(3,"First Name"),t.qZA(),t._UZ(4,"input",31),t.YNc(5,se,2,1,"div",10),t.qZA(),t.TgZ(6,"div",11)(7,"label"),t._uU(8,"Last Name"),t.qZA(),t._UZ(9,"input",32),t.YNc(10,le,2,1,"div",10),t.qZA(),t.TgZ(11,"div",11)(12,"label"),t._uU(13,"Phone No."),t.qZA(),t._UZ(14,"input",33),t.YNc(15,ae,2,1,"div",10),t.qZA()()),2&n){const e=t.oxw();t.xp6(4),t.Q6J("ngClass",t.VKq(6,g,e.submitted&&e.f.FIRST_NAME.errors)),t.xp6(1),t.Q6J("ngIf",e.submitted&&e.f.FIRST_NAME.errors),t.xp6(4),t.Q6J("ngClass",t.VKq(8,g,e.submitted&&e.f.LAST_NAME.errors)),t.xp6(1),t.Q6J("ngIf",e.submitted&&e.f.LAST_NAME.errors),t.xp6(4),t.Q6J("ngClass",t.VKq(10,g,e.submitted&&e.f.PHONE.errors)),t.xp6(1),t.Q6J("ngIf",e.submitted&&e.f.PHONE.errors)}}function ue(n,i){1&n&&(t.TgZ(0,"div",30),t._uU(1,"*First Name required"),t.qZA())}function de(n,i){if(1&n&&(t.TgZ(0,"div"),t.YNc(1,ue,2,0,"div",29),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",e.f.FIRST_NAME.errors.required)}}function pe(n,i){1&n&&(t.TgZ(0,"div",30),t._uU(1,"*Last Name required"),t.qZA())}function he(n,i){if(1&n&&(t.TgZ(0,"div"),t.YNc(1,pe,2,0,"div",29),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",e.f.LAST_NAME.errors.required)}}function me(n,i){1&n&&(t.TgZ(0,"div",30),t._uU(1,"*Phone No. required"),t.qZA())}function ge(n,i){if(1&n&&(t.TgZ(0,"div"),t.YNc(1,me,2,0,"div",29),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",e.f.PHONE.errors.required)}}function _e(n,i){if(1&n&&(t.TgZ(0,"div")(1,"div",11)(2,"label"),t._uU(3,"First Name"),t.qZA(),t._UZ(4,"input",31),t.YNc(5,de,2,1,"div",10),t.qZA(),t.TgZ(6,"div",11)(7,"label"),t._uU(8,"Last Name"),t.qZA(),t._UZ(9,"input",32),t.YNc(10,he,2,1,"div",10),t.qZA(),t.TgZ(11,"div",11)(12,"label"),t._uU(13,"Phone No."),t.qZA(),t._UZ(14,"input",33),t.YNc(15,ge,2,1,"div",10),t.qZA()()),2&n){const e=t.oxw();t.xp6(4),t.Q6J("ngClass",t.VKq(6,g,e.submitted&&e.f.FIRST_NAME.errors)),t.xp6(1),t.Q6J("ngIf",e.submitted&&e.f.FIRST_NAME.errors),t.xp6(4),t.Q6J("ngClass",t.VKq(8,g,e.submitted&&e.f.LAST_NAME.errors)),t.xp6(1),t.Q6J("ngIf",e.submitted&&e.f.LAST_NAME.errors),t.xp6(4),t.Q6J("ngClass",t.VKq(10,g,e.submitted&&e.f.PHONE.errors)),t.xp6(1),t.Q6J("ngIf",e.submitted&&e.f.PHONE.errors)}}function fe(n,i){1&n&&(t.TgZ(0,"div",39),t._UZ(1,"div",40),t.qZA())}function ve(n,i){1&n&&(t.TgZ(0,"div",41),t._uU(1," Image Uploaded Succesfuly!"),t.qZA())}function Te(n,i){1&n&&(t.TgZ(0,"div",42),t._uU(1," Image Upload Failed!"),t.qZA())}const Ee=function(n){return{"background-image":n}};function Ce(n,i){if(1&n&&(t.TgZ(0,"div",34),t._UZ(1,"div",35),t.YNc(2,fe,2,0,"div",36),t.YNc(3,ve,2,0,"div",37),t.YNc(4,Te,2,0,"div",38),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Gre("img-preview","fail"===e.selectedFile.status?"-error":"",""),t.Q6J("ngStyle",t.VKq(7,Ee,"url("+e.selectedFile.src+")")),t.xp6(1),t.Q6J("ngIf",e.selectedFile.pending),t.xp6(1),t.Q6J("ngIf","ok"===e.selectedFile.status),t.xp6(1),t.Q6J("ngIf","fail"===e.selectedFile.status)}}function xe(n,i){1&n&&(t.TgZ(0,"div",30),t._uU(1,"*Picture required"),t.qZA())}function Ae(n,i){if(1&n&&(t.TgZ(0,"div"),t.YNc(1,xe,2,0,"div",29),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.f.PICTURE.errors.required)}}function be(n,i){if(1&n&&(t.TgZ(0,"option",43),t._uU(1),t.qZA()),2&n){const e=i.$implicit;t.s9C("value",e.RULE_ID),t.xp6(1),t.Oqu(e.RULE_NAME)}}function Se(n,i){1&n&&t._UZ(0,"span")}class Ie{constructor(i,e){this.src=i,this.file=e,this.pending=!1,this.status="init"}}let M=(()=>{class n{constructor(e,s,r,l,o,c,d,p){this.formBuilder=e,this.route=s,this.router=r,this.usersService=l,this.alertService=o,this.ruleManagementService=c,this.imageService=d,this.localService=p,this.subs=new N.Y,this.loading=!1,this.submitted=!1,this.selectedBPName=null,this.rules=null,this.bp=null,this.contact=null,this.apiurl=T.N.apiUrl,this.selectemail=null,this.isVTI=!1,this.isSuperUser=!1,this.rulelocal=JSON.parse(this.localService.getKey("rule"))}ngOnInit(){this.rulelocal.ISSUPERADMIN&&(this.isSuperUser=!0),this.id=this.route.snapshot.params.id,this.isAddMode=!this.id;const e=[a.kI.minLength(6)];this.isAddMode&&e.push(a.kI.required),this.form=this.formBuilder.group({USERNAME:["",a.kI.required],PASSWORD:["",e],FIRST_NAME:["",a.kI.required],LAST_NAME:["",a.kI.required],COMPANY_NAME:["",a.kI.required],PHONE:["",a.kI.required],BIO:["",a.kI.required],PICTURE:["",a.kI.required],RULE_ID:["",a.kI.required],EMAIL:["",a.kI.required]}),this.isAddMode||this.subs.add(this.usersService.getById(this.id).pipe((0,m.P)()).subscribe(s=>{this.form.patchValue(s)})),this.subs.add(this.ruleManagementService.getAll().subscribe(s=>this.rules=s))}get f(){return this.form.controls}onSubmit(){this.submitted=!0,this.alertService.clear(),this.loading=!0,this.isAddMode?this.createUser():this.updateUser()}onCompanySelected(e){37891===parseInt(e.COMPANY_ID)&&1==this.isSuperUser?(this.isVTI=!0,this.form.get("COMPANY_ID").setValue(e.COMPANY_ID),this.form.get("COMPANY_NAME").setValue(e.COMPANY_NAME),this.setEmptyvalue()):(this.isVTI=!1,this.form.get("COMPANY_ID").setValue(e.COMPANY_ID),this.form.get("COMPANY_NAME").setValue(e.COMPANY_NAME),this.setEmptyvalue())}onSelection(e){1==e.CONTACT_NAME.split(" ").length?this.form.get("FIRST_NAME").setValue(e.CONTACT_NAME):this.form.get("FIRST_NAME").setValue(e.CONTACT_NAME.substr(0,e.CONTACT_NAME.indexOf(" "))),""!=e.CONTACT_NAME.substr(e.CONTACT_NAME.indexOf(" ")+1)?this.form.get("LAST_NAME").setValue(e.CONTACT_NAME.substr(e.CONTACT_NAME.indexOf(" ")+1)):this.form.get("LAST_NAME").setValue(e.CONTACT_NAME.substr(0,e.CONTACT_NAME.indexOf(" "))),this.form.get("PASSWORD").setValue(e.EMAIL),this.form.get("USERNAME").setValue(e.EMAIL),this.form.get("PHONE").setValue(e.PHONE01)}createUser(){this.alertService.loading(),this.subs.add(this.usersService.register(this.form.value).pipe((0,m.P)()).subscribe({next:()=>{this.alertService.success(),this.router.navigate(["../"],{relativeTo:this.route})},error:e=>{this.alertService.error(e),this.loading=!1}}))}updateUser(){this.alertService.loading(),this.subs.add(this.usersService.update(this.id,this.form.value).pipe((0,m.P)()).subscribe({next:()=>{this.alertService.success(),this.router.navigate(["../../"],{relativeTo:this.route})},error:e=>{this.alertService.error(e),this.loading=!1}}))}onSuccess(){this.selectedFile.pending=!1,this.selectedFile.status="ok"}onError(){this.selectedFile.pending=!1,this.selectedFile.status="fail",this.selectedFile.src=""}processFile(e){const s=e.files[0],r=new FileReader;this.form.value.PICTURE&&this.imageService.deleteImage(this.form.value.PICTURE).pipe((0,m.P)()).subscribe(),r.addEventListener("load",l=>{this.selectedFile=new Ie(l.target.result,s),this.imageService.uploadImage(this.selectedFile.file).subscribe(o=>{this.form.get("PICTURE").setValue(o.filename),this.onSuccess()},o=>{this.onError()})}),r.readAsDataURL(s)}setEmptyvalue(){this.form.get("FIRST_NAME").setValue(""),this.form.get("LAST_NAME").setValue(""),this.form.get("PHONE").setValue(""),this.form.get("BIO").setValue(""),this.form.get("PASSWORD").setValue(""),this.selectemail=""}ngOnDestroy(){this.subs.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(a.qu),t.Y36(v.gz),t.Y36(v.F0),t.Y36(w.x),t.Y36(D.c9),t.Y36(F.P),t.Y36(O),t.Y36(L.C))},n.\u0275cmp=t.Xpm({type:n,selectors:[["ng-component"]],decls:48,vars:20,consts:[[1,"title","d-flex","align-items-center","flex-wrap","mb-30"],["class","mr-40",4,"ngIf"],["routerLink","/user-management",1,"main-btn","primary-btn","rounded-btn","btn-hover","btn-sm"],[1,"lni","lni-chevron-left","mr-5"],[1,"row"],[3,"formGroup","ngSubmit"],[1,"col-lg-6"],[1,"card-style","mb-30"],[1,"divider"],["class","input-style-1",4,"ngIf"],[4,"ngIf"],[1,"input-style-1"],["formControlName","BIO","placeholder","Message","rows","5",3,"ngClass"],["type","file","accept","image/*",3,"change"],["imageInput",""],["class","img-preview-container",4,"ngIf"],["type","text","formControlName","PICTURE",3,"ngClass"],[1,"select-style-1"],[1,"select-position"],["formControlName","RULE_ID"],[3,"value",4,"ngFor","ngForOf"],["routerLink","/user-management",1,"main-btn","primary-btn-outline","rounded-btn","btn-hover","btn-sm"],[1,"main-btn","primary-btn","rounded-btn","btn-hover","btn-sm",3,"disabled"],[1,"mr-40"],["type","text","formControlName","COMPANY_NAME"],["type","text","formControlName","USERNAME"],["type","text","formControlName","EMAIL"],["for","PASSWORD"],["type","password","formControlName","PASSWORD",3,"ngClass"],["style","color:red",4,"ngIf"],[2,"color","red"],["type","text","formControlName","FIRST_NAME",3,"ngClass"],["type","text","formControlName","LAST_NAME",3,"ngClass"],["type","text","formControlName","PHONE",3,"ngClass"],[1,"img-preview-container"],[3,"ngStyle"],["class","img-loading-overlay",4,"ngIf"],["class","alert alert-success",4,"ngIf"],["class","alert alert-danger",4,"ngIf"],[1,"img-loading-overlay"],[1,"img-spinning-circle"],[1,"alert","alert-success"],[1,"alert","alert-danger"],[3,"value"]],template:function(e,s){if(1&e){const r=t.EpF();t.TgZ(0,"div",0),t.YNc(1,J,2,0,"h4",1),t.YNc(2,K,2,0,"h4",1),t.TgZ(3,"button",2),t._UZ(4,"i",3),t._uU(5,"Back"),t.qZA()(),t.TgZ(6,"div",4)(7,"form",5),t.NdJ("ngSubmit",function(){return s.onSubmit()}),t.TgZ(8,"div",6)(9,"div",7)(10,"h5"),t._uU(11,"User Description"),t.qZA(),t.TgZ(12,"span",8),t._UZ(13,"hr"),t.qZA(),t.YNc(14,j,4,0,"div",9),t.YNc(15,z,4,0,"div",9),t.YNc(16,W,4,0,"div",9),t.YNc(17,ie,6,5,"div",9),t.YNc(18,ce,16,12,"div",10),t.YNc(19,_e,16,12,"div",10),t.TgZ(20,"div",11)(21,"label"),t._uU(22,"Bio"),t.qZA(),t._UZ(23,"textarea",12),t.qZA(),t.TgZ(24,"div",11)(25,"label"),t._uU(26,"Select Image"),t.qZA(),t.TgZ(27,"input",13,14),t.NdJ("change",function(){t.CHM(r);const o=t.MAs(28);return s.processFile(o)}),t.qZA()(),t.YNc(29,Ce,5,9,"div",15),t.TgZ(30,"div",11)(31,"label"),t._uU(32,"Picture"),t.qZA(),t._UZ(33,"input",16),t.YNc(34,Ae,2,1,"div",10),t.qZA(),t.TgZ(35,"div",17)(36,"label"),t._uU(37,"Role"),t.qZA(),t.TgZ(38,"div",18)(39,"select",19),t.YNc(40,be,2,2,"option",20),t.qZA()()(),t.TgZ(41,"div")(42,"button",21),t._uU(43," Cancel "),t.qZA(),t._uU(44,"\xa0 "),t.TgZ(45,"button",22),t.YNc(46,Se,1,0,"span",10),t._uU(47," \xa0Save\xa0 "),t.qZA()()()()()()}2&e&&(t.xp6(1),t.Q6J("ngIf",s.isAddMode),t.xp6(1),t.Q6J("ngIf",!s.isAddMode),t.xp6(5),t.Q6J("formGroup",s.form),t.xp6(7),t.Q6J("ngIf",s.isAddMode),t.xp6(1),t.Q6J("ngIf",s.isAddMode),t.xp6(1),t.Q6J("ngIf",s.isAddMode),t.xp6(1),t.Q6J("ngIf",s.isAddMode),t.xp6(1),t.Q6J("ngIf",s.isVTI),t.xp6(1),t.Q6J("ngIf",!s.isVTI),t.xp6(4),t.Q6J("ngClass",t.VKq(16,g,s.submitted&&s.f.BIO.errors)),t.xp6(6),t.Q6J("ngIf",s.selectedFile),t.xp6(4),t.Q6J("ngClass",t.VKq(18,g,s.submitted&&s.f.PICTURE.errors)),t.xp6(1),t.Q6J("ngIf",s.submitted&&s.f.PICTURE.errors),t.xp6(6),t.Q6J("ngForOf",s.rules),t.xp6(5),t.Q6J("disabled",s.loading),t.xp6(1),t.Q6J("ngIf",s.loading))},directives:[f.O5,v.rH,a._Y,a.JL,a.sg,a.Fj,a.JJ,a.u,f.mk,f.PC,a.EJ,f.sg,a.YN,a.Kr],styles:['.image-upload-container[_ngcontent-%COMP%]{cursor:pointer}.img-preview-container[_ngcontent-%COMP%]{background-color:#f7f7f7;position:relative}.img-preview-container[_ngcontent-%COMP%]   .img-preview[_ngcontent-%COMP%]{background:center center no-repeat;background-size:contain;height:116px;width:116px}.img-preview-container[_ngcontent-%COMP%]   .img-preview-error[_ngcontent-%COMP%]{display:none}.img-loading-overlay[_ngcontent-%COMP%]{background-color:#000;inset:0;opacity:.2;position:absolute}.img-spinning-circle[_ngcontent-%COMP%]{display:inline-block;width:64px;height:64px;margin:auto;position:absolute;inset:0}.img-spinning-circle[_ngcontent-%COMP%]:after{content:" ";display:block;width:46px;height:46px;margin:1px;border-radius:50%;border:5px solid #fff;border-color:#fff transparent #fff transparent;animation:lds-dual-ring 1.2s linear infinite}@keyframes lds-dual-ring{0%{transform:rotate(0)}to{transform:rotate(360deg)}}']}),n})(),ye=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["ng-component"]],decls:1,vars:0,template:function(e,s){1&e&&t._UZ(0,"router-outlet")},directives:[v.lC],encapsulation:2}),n})();var Ne=u(3821),U=u.n(Ne),P=u(1769),we=u(440),S=u(9517),k=u(18);function De(n,i){1&n&&(t.TgZ(0,"tr")(1,"th")(2,"h6"),t._uU(3,"Full Name"),t.qZA()(),t.TgZ(4,"th")(5,"h6"),t._uU(6,"Username"),t.qZA()(),t.TgZ(7,"th")(8,"h6"),t._uU(9,"Email"),t.qZA()(),t.TgZ(10,"th")(11,"h6"),t._uU(12,"Company"),t.qZA()(),t.TgZ(13,"th")(14,"h6"),t._uU(15,"Action"),t.qZA()()())}function Fe(n,i){1&n&&(t.TgZ(0,"tr")(1,"th")(2,"h6"),t._uU(3,"Email"),t.qZA()(),t.TgZ(4,"th")(5,"h6"),t._uU(6,"Action"),t.qZA()()())}function Oe(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"tr")(1,"td")(2,"a",28),t._uU(3),t.qZA()(),t.TgZ(4,"td")(5,"button",29),t._UZ(6,"i",30),t.qZA(),t.TgZ(7,"ul",31)(8,"li",32)(9,"a",33),t.NdJ("click",function(){const l=t.CHM(e).$implicit;return t.oxw(2).confirmBox("confirm",l)}),t._uU(10,"Resend Email"),t.qZA()(),t.TgZ(11,"li",32)(12,"a",34),t._uU(13,"Edit"),t.qZA()(),t.TgZ(14,"li",32)(15,"a",33),t.NdJ("click",function(){const l=t.CHM(e).$implicit;return t.oxw(2).confirmBox("delete",l)}),t._uU(16,"Delete"),t.qZA()()()()()}if(2&n){const e=i.$implicit;t.xp6(2),t.MGl("href","/profile/",e.USERNAME,"",t.LSH),t.xp6(1),t.AsE("",e.FIRST_NAME," ",e.LAST_NAME,""),t.xp6(9),t.MGl("routerLink","edit/",e.ID,"")}}const Z=function(n,i){return{itemsPerPage:n,currentPage:i}};function Le(n,i){if(1&n&&(t.TgZ(0,"tbody"),t.YNc(1,Oe,17,4,"tr",27),t.ALo(2,"paginate"),t.ALo(3,"filter"),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",t.xi3(2,1,t.xi3(3,4,e.users,e.filterdata),t.WLB(7,Z,e.count,e.p)))}}function Me(n,i){1&n&&(t.TgZ(0,"span"),t._UZ(1,"i",48),t.qZA())}function Ue(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"tr")(1,"td",35)(2,"div",36)(3,"div",37),t._UZ(4,"img",38),t.qZA(),t.TgZ(5,"div",39)(6,"p")(7,"a",28),t._uU(8),t.qZA()()()()(),t.TgZ(9,"td",35)(10,"p")(11,"a",40),t._uU(12),t.qZA()()(),t.TgZ(13,"td",35)(14,"p"),t._uU(15),t.qZA()(),t.TgZ(16,"td",35)(17,"p")(18,"a",41),t._uU(19),t.qZA()()(),t.TgZ(20,"td")(21,"div",42)(22,"button",43),t.NdJ("click",function(){const l=t.CHM(e).$implicit;return t.oxw(2).confirmBox("confirm",l)}),t._UZ(23,"i",44),t.qZA(),t._uU(24,"\xa0 "),t.TgZ(25,"button",45),t._UZ(26,"i",46),t.qZA(),t._uU(27,"\xa0 "),t.TgZ(28,"button",47),t.NdJ("click",function(){const l=t.CHM(e).$implicit;return t.oxw(2).confirmBox("delete",l)}),t.YNc(29,Me,2,0,"span",22),t.qZA()()()()}if(2&n){const e=i.$implicit,s=t.oxw(2);t.xp6(4),t.s9C("src",s.apiurl+e.PICTURE,t.LSH),t.xp6(3),t.MGl("href","/profile/",e.USERNAME,"",t.LSH),t.xp6(1),t.AsE("",e.FIRST_NAME," ",e.LAST_NAME,""),t.xp6(4),t.Oqu(e.USERNAME),t.xp6(3),t.Oqu(e.EMAIL),t.xp6(3),t.MGl("title","ID: ",e.COMPANY_ID,""),t.xp6(1),t.Oqu(e.COMPANY_NAME),t.xp6(6),t.MGl("routerLink","edit/",e.ID,""),t.xp6(3),t.Q6J("disabled",e.isDeleting),t.xp6(1),t.Q6J("ngIf",!e.isDeleting)}}function Pe(n,i){if(1&n&&(t.TgZ(0,"tbody"),t.YNc(1,Ue,30,11,"tr",27),t.ALo(2,"paginate"),t.ALo(3,"filter"),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",t.xi3(2,1,t.xi3(3,4,e.users,e.filterdata),t.WLB(7,Z,e.count,e.p)))}}const ke=[{path:"user-management",component:ye,children:[{path:"",component:(()=>{class n{constructor(e,s,r,l,o,c){this.apmService=e,this.usersService=s,this.rulesService=r,this.imageService=l,this.alertService=o,this.localService=c,this.subs=new N.Y,this.users=null,this.rules=null,this.user=null,this.rule=null,this.bp=null,this.p=1,this.count=10,this.countdata=null,this.apiurl=T.N.apiUrl+"/image/";const d=e.init({serviceName:T.N.apmServerAppName,serverUrl:T.N.apmServerUrl,environment:T.N.apmServerEnv});this.user=JSON.parse(this.localService.getKey("user")),d.setUserContext({username:this.user.USERNAME,id:this.user.ID,email:this.user.EMAIL})}ngOnInit(){this.mobileMode=JSON.parse(localStorage.getItem("mobileMode")),this.subs.add(this.usersService.getAll().pipe((0,m.P)()).subscribe(e=>{this.users=e,this.countdata=this.users.length})),this.subs.add(this.rulesService.getAll().pipe((0,m.P)()).subscribe(e=>this.rules=e)),this.user=new P.X(JSON.parse(this.localService.getKey("user"))),this.rule=new P.X(JSON.parse(this.localService.getKey("rule")))}deleteUser(e){this.alertService.loading();const s=this.users.find(r=>r.ID===e.ID);this.subs.add(this.usersService.delete(e.ID).pipe((0,m.P)()).subscribe(()=>{s.isDeleting=!0,this.users=this.users.filter(r=>r.ID!==e.ID),this.countdata=this.users.length,this.alertService.success(),this.subs.add(this.imageService.deleteImage(s.PICTURE).pipe((0,m.P)()).subscribe())},r=>{this.alertService.error(r)}))}roleIdToName(e){let s;try{s=this.rules.find(r=>r.ROLE_ID==e).ROLE_NAME}catch(r){}finally{return s}}companyIdToName(e){let s;try{s=this.bp.find(r=>r.COMPANY_ID=e).COMPANY_NAME}catch(r){}finally{return s}}resendEmail(e){e.PASSWORD=e.USERNAME,this.alertService.loading(),this.subs.add(this.usersService.resendemail(e).pipe((0,m.P)()).subscribe(()=>{this.alertService.success()},s=>{this.alertService.error(s)}))}confirmBox(e,s){"delete"==e&&U().fire({title:"Are you sure want to delete?",text:s.USERNAME,icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",cancelButtonText:"Cancel"}).then(r=>{r.value&&this.deleteUser(s)}),"confirm"==e&&U().fire({title:"Are you sure want to resend email?",text:"this action will reset password "+s.USERNAME,icon:"question",showCancelButton:!0,confirmButtonText:"Yes, send email!",cancelButtonText:"Cancel"}).then(r=>{r.value&&this.resendEmail(s)})}ngOnDestroy(){this.subs.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(we.J5),t.Y36(w.x),t.Y36(F.P),t.Y36(O),t.Y36(D.c9),t.Y36(L.C))},n.\u0275cmp=t.Xpm({type:n,selectors:[["ng-component"]],decls:46,vars:7,consts:[[1,"title","d-flex","align-items-center","flex-wrap","mb-30"],[1,"mr-40"],["routerLink","add",1,"main-btn","primary-btn","btn-hover","btn-sm"],[1,"lni","lni-plus","mr-5"],[1,"tables-wrapper"],[1,"row"],[1,"col-lg-12"],[1,"card-style","mb-30"],[1,"row","align-items-center"],[1,"col-md-6"],[1,"d-flex","flex-wrap","justify-content-between","align-items-center","py-3"],[1,"left"],[1,"select-style-3"],[1,"select-position"],[1,"light-bg",3,"ngModel","ngModelChange"],[1,"right"],[1,"table-search","d-flex"],["action","#"],["type","text","name","something","placeholder","Search...",3,"ngModel","ngModelChange"],[1,"lni","lni-search-alt"],[1,"table-wrapper","table-responsive"],[1,"table"],[4,"ngIf"],[1,"pt-10","d-flex","flex-wrap","justify-content-between"],[1,"text-sm","text-gray"],[1,"text-right"],[3,"pageChange"],[4,"ngFor","ngForOf"],[3,"href"],["id","moreAction1","data-bs-toggle","dropdown","aria-expanded","false",1,"main-btn"],[1,"lni","lni-more-alt"],["aria-labelledby","moreAction1",1,"dropdown-menu","dropdown-menu-end"],[1,"dropdown-item"],[1,"text-gray",3,"click"],[1,"text-gray",2,"cursor","pointer",3,"routerLink"],[1,"min-width"],[1,"lead"],[1,"lead-image"],["alt","",3,"src"],[1,"lead-text"],["data-toggle","tooltip"],["data-toggle","tooltip",2,"cursor","pointer",3,"title"],[1,"action"],[1,"text-primary",2,"cursor","pointer",3,"click"],[1,"lni","lni-reply"],[1,"text-primary",2,"cursor","pointer",3,"routerLink"],[1,"lni","lni-pencil-alt"],[1,"text-danger",3,"disabled","click"],[1,"lni","lni-trash-can"]],template:function(e,s){1&e&&(t.TgZ(0,"div",0)(1,"h4",1),t._uU(2,"Users Management"),t.qZA(),t.TgZ(3,"button",2),t._UZ(4,"i",3),t._uU(5," Add "),t.qZA()(),t.TgZ(6,"div",4)(7,"div",5)(8,"div",6)(9,"div",7)(10,"div",8),t._UZ(11,"div",9),t.qZA(),t.TgZ(12,"div",10)(13,"div",11)(14,"p"),t._uU(15,"Show "),t.TgZ(16,"span")(17,"div",12)(18,"div",13)(19,"select",14),t.NdJ("ngModelChange",function(l){return s.count=l}),t.TgZ(20,"option"),t._uU(21," 10 "),t.qZA(),t.TgZ(22,"option"),t._uU(23," 20 "),t.qZA(),t.TgZ(24,"option"),t._uU(25," 50 "),t.qZA()()()()(),t._uU(26," entries "),t.qZA()(),t.TgZ(27,"div",15)(28,"div",16)(29,"form",17)(30,"input",18),t.NdJ("ngModelChange",function(l){return s.filterdata=l}),t.qZA(),t.TgZ(31,"button"),t._UZ(32,"i",19),t.qZA()()()()(),t.TgZ(33,"div",20)(34,"table",21)(35,"thead"),t.YNc(36,De,16,0,"tr",22),t.YNc(37,Fe,7,0,"tr",22),t.qZA(),t.YNc(38,Le,4,10,"tbody",22),t.YNc(39,Pe,4,10,"tbody",22),t.qZA()(),t.TgZ(40,"div",23)(41,"div",11)(42,"p",24),t._uU(43),t.qZA()(),t.TgZ(44,"div",25)(45,"pagination-controls",26),t.NdJ("pageChange",function(l){return s.p=l}),t.qZA()()()()()()()),2&e&&(t.xp6(19),t.Q6J("ngModel",s.count),t.xp6(11),t.Q6J("ngModel",s.filterdata),t.xp6(6),t.Q6J("ngIf",!s.mobileMode),t.xp6(1),t.Q6J("ngIf",s.mobileMode),t.xp6(1),t.Q6J("ngIf",s.mobileMode),t.xp6(1),t.Q6J("ngIf",!s.mobileMode),t.xp6(4),t.hij("Total ",s.countdata," users"))},directives:[v.rH,a.EJ,a.JJ,a.On,a.YN,a.Kr,a._Y,a.JL,a.F,a.Fj,f.O5,f.sg,v.yS,S.LS],pipes:[S._s,k.Z],encapsulation:2}),n})()},{path:"add",component:M},{path:"edit/:id",component:M}]}];let Ze=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[v.Bz.forChild(ke)],v.Bz]}),n})();var Be=u(9738);class Re extends Be.w{constructor(i,e){super()}schedule(i,e=0){return this}}class B extends Re{constructor(i,e){super(i,e),this.scheduler=i,this.work=e,this.pending=!1}schedule(i,e=0){if(this.closed)return this;this.state=i;const s=this.id,r=this.scheduler;return null!=s&&(this.id=this.recycleAsyncId(r,s,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(r,this.id,e),this}requestAsyncId(i,e,s=0){return setInterval(i.flush.bind(i,this),s)}recycleAsyncId(i,e,s=0){if(null!==s&&this.delay===s&&!1===this.pending)return e;clearInterval(e)}execute(i,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const s=this._execute(i,e);if(s)return s;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(i,e){let r,s=!1;try{this.work(i)}catch(l){s=!0,r=!!l&&l||new Error(l)}if(s)return this.unsubscribe(),r}_unsubscribe(){const i=this.id,e=this.scheduler,s=e.actions,r=s.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&s.splice(r,1),null!=i&&(this.id=this.recycleAsyncId(e,i,null)),this.delay=null}}let R=(()=>{class n{constructor(e,s=n.now){this.SchedulerAction=e,this.now=s}schedule(e,s=0,r){return new this.SchedulerAction(this,e).schedule(r,s)}}return n.now=()=>Date.now(),n})();class _ extends R{constructor(i,e=R.now){super(i,()=>_.delegate&&_.delegate!==this?_.delegate.now():e()),this.actions=[],this.active=!1,this.scheduled=void 0}schedule(i,e=0,s){return _.delegate&&_.delegate!==this?_.delegate.schedule(i,e,s):super.schedule(i,e,s)}flush(i){const{actions:e}=this;if(this.active)return void e.push(i);let s;this.active=!0;do{if(s=i.execute(i.state,i.delay))break}while(i=e.shift());if(this.active=!1,s){for(;i=e.shift();)i.unsubscribe();throw s}}}new class Ve extends _{flush(i){this.active=!0,this.scheduled=void 0;const{actions:e}=this;let s,r=-1,l=e.length;i=i||e.shift();do{if(s=i.execute(i.state,i.delay))break}while(++r<l&&(i=e.shift()));if(this.active=!1,s){for(;++r<l&&(i=e.shift());)i.unsubscribe();throw s}}}(class qe extends B{constructor(i,e){super(i,e),this.scheduler=i,this.work=e}requestAsyncId(i,e,s=0){return null!==s&&s>0?super.requestAsyncId(i,e,s):(i.actions.push(this),i.scheduled||(i.scheduled=requestAnimationFrame(()=>i.flush(null))))}recycleAsyncId(i,e,s=0){if(null!==s&&s>0||null===s&&this.delay>0)return super.recycleAsyncId(i,e,s);0===i.actions.length&&(cancelAnimationFrame(e),i.scheduled=void 0)}});let $e=1;const Ye=Promise.resolve(),A={};function q(n){return n in A&&(delete A[n],!0)}const V={setImmediate(n){const i=$e++;return A[i]=!0,Ye.then(()=>q(i)&&n()),i},clearImmediate(n){q(n)}};new class Je extends _{flush(i){this.active=!0,this.scheduled=void 0;const{actions:e}=this;let s,r=-1,l=e.length;i=i||e.shift();do{if(s=i.execute(i.state,i.delay))break}while(++r<l&&(i=e.shift()));if(this.active=!1,s){for(;++r<l&&(i=e.shift());)i.unsubscribe();throw s}}}(class Qe extends B{constructor(i,e){super(i,e),this.scheduler=i,this.work=e}requestAsyncId(i,e,s=0){return null!==s&&s>0?super.requestAsyncId(i,e,s):(i.actions.push(this),i.scheduled||(i.scheduled=V.setImmediate(i.flush.bind(i,null))))}recycleAsyncId(i,e,s=0){if(null!==s&&s>0||null===s&&this.delay>0)return super.recycleAsyncId(i,e,s);0===i.actions.length&&(V.clearImmediate(e),i.scheduled=void 0)}});RegExp(/[&<>"']/g.source);const At=new t.OlP("ng-select-selection-model");function bt(){return new St}class St{constructor(){this._selected=[]}get value(){return this._selected}select(i,e,s){if(i.selected=!0,(!i.children||!e&&s)&&this._selected.push(i),e)if(i.parent){const r=i.parent.children.length,l=i.parent.children.filter(o=>o.selected).length;i.parent.selected=r===l}else i.children&&(this._setChildrenSelectedState(i.children,!0),this._removeChildren(i),this._selected=s&&this._activeChildren(i)?[...this._selected.filter(r=>r.parent!==i),i]:[...this._selected,...i.children.filter(r=>!r.disabled)])}unselect(i,e){if(this._selected=this._selected.filter(s=>s!==i),i.selected=!1,e)if(i.parent&&i.parent.selected){const s=i.parent.children;this._removeParent(i.parent),this._removeChildren(i.parent),this._selected.push(...s.filter(r=>r!==i&&!r.disabled)),i.parent.selected=!1}else i.children&&(this._setChildrenSelectedState(i.children,!1),this._removeChildren(i))}clear(i){this._selected=i?this._selected.filter(e=>e.disabled):[]}_setChildrenSelectedState(i,e){for(const s of i)s.disabled||(s.selected=e)}_removeChildren(i){this._selected=[...this._selected.filter(e=>e.parent!==i),...i.children.filter(e=>e.parent===i&&e.disabled&&e.selected)]}_removeParent(i){this._selected=this._selected.filter(e=>e!==i)}_activeChildren(i){return i.children.every(e=>!e.disabled||e.selected)}}let It=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({providers:[{provide:At,useValue:bt}],imports:[[f.ez]]}),n})(),yt=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[f.ez,a.UX,Ze,It,a.u5,S.JX,k.h]]}),n})()}}]);